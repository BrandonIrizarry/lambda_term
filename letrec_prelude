# This file focuses on definitions necessary for testing letrec. #

def identity := \x.x;
def first := \x.\y.x;
def second := \x.\y.y;
def true := first;
def false := second;
def succ n s := (s false n);

def zero := identity;
def one := (succ zero);
def two := (succ one);
def three := (succ two);
def four := (succ three);
def five := (succ four);
def six := (succ five);
def seven := (succ six);
def eight := (succ seven);
def nine := (succ eight);
def ten := (succ nine);
def eleven := (succ ten);
def twelve := (succ eleven);
def thirteen := (succ twelve);
def fourteen := (succ thirteen);
def fifteen := (succ fourteen);

def iszero n := (n first);
def if c e1 e2 := (c e1 e2);
def not x := (x false true);
def pred n := (if (iszero n) zero (n second));

letrec _sub x y := (if (iszero y) x (_sub (pred x) (pred y))) in def sub := _sub;

let abs_diff x y := (add (sub x y) (sub y x))
    in def equal x y := (iszero (abs_diff x y));

def greater x y := (not (iszero (sub x y)));

letrec _div x y := (if (greater y x) zero (succ (_div (sub x y) y)))
    in def div := _div;
